# Telegram Bot –¥–ª—è RuChat - –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. **–ü–∞—Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
–ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–µ `password` —Ç–æ—á–Ω–æ —Ç–∞–∫, –∫–∞–∫ –æ–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Firebase:
- –ï—Å–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ö–µ—à (—á–∏—Å–ª–æ)
- –≠—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
–ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ:
1. –ó–∞–ø–∏—Å—å –≤ `blockedUsers/{username}` —Å `blocked: true`
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `accounts/{username}/blocked.admin = true`
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–∫–∏–¥—ã–≤–∞–µ—Ç—Å—è –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
4. –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —ç–∫—Ä–∞–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### 3. **–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞**
–ö–Ω–æ–ø–∫–∞ "‚úÖ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å" –ø–æ—è–≤–ª—è–µ—Ç—Å—è —É –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## üöÄ –ó–∞–ø—É—Å–∫

```bash
cd c:\RUCHATMESSEN\functions
npm run start:bot
```

## üìã –ö–æ–º–∞–Ω–¥—ã

| –ö–Ω–æ–ø–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ |
| üë• –í—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã | –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ù–∞–π—Ç–∏ –ø–æ username |
| ‚ö´ –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ |
| ‚ùì –ü–æ–º–æ—â—å | –°–ø—Ä–∞–≤–∫–∞ |

## üîê –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞

### –ö–∞–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å:
1. `/start` ‚Üí "üë• –í—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã"
2. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å: `20091326`
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –ù–∞–∂–º–∏—Ç–µ "‚ö´ –í —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫"
5. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ

### –ö–∞–∫ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å:
1. –í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ–º–µ—á–µ–Ω üö´)
2. –ù–∞–∂–º–∏—Ç–µ "‚úÖ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å"
3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:
```bash
# –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
https://web-messenger-1694a-default-rtdb.firebaseio.com/blockedUsers.json

# –ß–µ—Ä–µ–∑ curl
curl https://web-messenger-1694a-default-rtdb.firebaseio.com/blockedUsers.json
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### 1. –ó–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞:
```
–ë–æ—Ç ‚Üí –í—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ ‚Üí –í —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ ‚Üí –î–∞
```

### 2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ –ø–æ–¥ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º:
1. –û—Ç–∫—Ä–æ–π—Ç–µ `index.html`
2. –í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ
3. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è: "üö´ –ê–ö–ö–ê–£–ù–¢ –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù"

### 3. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Firebase Console:
- `blockedUsers/{username}` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å `blocked: true`
- `accounts/{username}/blocked/admin` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `true`

## üîß –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å:
```bash
cd functions
node test-block-user.js <username>
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Firebase:
```bash
node test-firebase.js
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### blockedUsers/{username}:
```json
{
  "blocked": true,
  "blockedAt": 1234567890,
  "reason": "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–º",
  "blockedBy": "admin_telegram"
}
```

### accounts/{username}/blocked:
```json
{
  "admin": true
}
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **–ü–∞—Ä–æ–ª–∏**: –•—Ä–∞–Ω—è—Ç—Å—è –≤ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ (—á–∏—Å–ª–∞)
2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞**: –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏:
   - –í–≤–æ–¥–µ –ø–∞—Ä–æ–ª—è (`login()`)
   - –ó–∞–≥—Ä—É–∑–∫–µ –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`doLoginAfterAuth()`)
   - –ê–≤—Ç–æ–≤—Ö–æ–¥–µ (`autoLoginFromDevice()`)
   - –ó–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (`checkBlockOnLoad()`)

## üêõ Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
taskkill /F /IM node.exe
npm run start:bot
```

### –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∑–∞–ª–æ–≥–∏–Ω–µ–Ω –≤ Firebase
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞:
   ```json
   {
     "rules": {
       "blockedUsers": {
         "$username": { ".read": true }
       }
     }
   }
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `blockedUsers/{username}` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `accounts/{username}/blocked/admin` - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å
3. –û—á–µ—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏

## üìß –ü–æ–¥–¥–µ—Ä–∂–∫–∞

ruchat.offical@mail.ru
